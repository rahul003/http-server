/*!CK:1722595400!*//*1392791373,178183213*/

if (self.CavalryLogger) { CavalryLogger.start_js(["Cp4xt"]); }

__d("DynamicFacepile",["DOM","TooltipLink","URI","XHPTemplate","copyProperties"],function(a,b,c,d,e,f,g,h,i,j,k){function l(){}k(l.prototype,{init:function(m,n,o,p){this._facepile=o;this._maxFacepileSize=n;this._memberIDs=m;this._facepileItemMap={};var q=g.scry(this._facepile,'li');for(var r=0,s=m.length;r<s;++r)this._facepileItemMap[m[r]]=q[r];this._template=p;},containsID:function(m){return this._facepileItemMap[m];},removeFacepileItem:function(m){var n=this._facepileItemMap[m.uid];if(!n)return;delete this._facepileItemMap[m.uid];this._memberIDs.splice(this._memberIDs.indexOf(m.uid),1);g.remove(n);},addFacepileItem:function(m){var n=this._template.render(),o=j.getNode(n,'img');o.src=m.photo;var p=j.getNode(n,'anchor');p.href=i('/profile.php').addQueryData({id:m.uid});h.setTooltipText(p,m.name);g.prependContent(this._facepile,n);this._facepileItemMap[m.uid]=n;this._memberIDs.unshift(m.uid);if(this._memberIDs.length>this._maxFacepileSize){var q=this._memberIDs.pop(),r=this._facepileItemMap[q];g.remove(r);delete this._facepileItemMap[q];}}});e.exports=l;});
__d("FriendsDashSideCol",["Arbiter","AsyncRequest","CSS","DOM","PageTransitions","UIIntentionalStreamMessage","$"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n={init:function(o){this._flid=o;var p='listeditor/friend_lists_changed',q=g.subscribe(p,function(r,s){if(r==p&&s.list_info.list_id==this._flid){if(s.refresh_member_box)new h('/ajax/friends/lists/list_modified.php').setMethod('GET').setReadOnly(true).setData({list_id:this._flid}).send();if(s.removed_uid){j.scry(m('home_stream'),'.aid_'+s.removed_uid).forEach(i.hide);}else if(s.undo_remove&&s.added_uid){j.scry(m('home_stream'),'.aid_'+s.added_uid).forEach(i.show);}else g.inform(l.REFRESH_STREAM,{filter:'fl_'+this._flid,noScroll:1});}}.bind(this),g.SUBSCRIBE_NEW);k.registerHandler(g.unsubscribe.bind(null,q));}};e.exports=n;});
__d("legacy:friends-dash-sidecol-js",["FriendsDashSideCol"],function(a,b,c,d){a.FriendsDashSideCol=b('FriendsDashSideCol');},3);
__d("FriendListFilterNUXDialog",["Arbiter"],function(a,b,c,d,e,f,g){var h={init:function(i){g.subscribe(['FriendListMemberTypeahead/add','FriendListSuggestions/add'],function(){i.hide();});}};e.exports=h;});
__d("FriendListMembersBox",["Arbiter","CSS","DOM","DynamicFacepile","PageTransitions","copyProperties","tx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(){}l(n.prototype,{init:function(o,p,q,r,s,t,u){this._root=o;this._flid=p;this._listSize=r;this._headerTitle=i.find(this._root,'.uiHeaderTitle');this._headerActions=i.find(this._root,'.uiHeaderActions a');this._facepile=new j();this._facepile.init(q,s,t.firstChild,u);var v=[g.subscribe(['FriendListSuggestions/add','FriendListMemberTypeahead/add','FriendListHovercard/add'],this.handleAddEvent.bind(this)),g.subscribe('FriendListHovercard/remove',this.handleRemoveEvent.bind(this))];k.registerHandler(function(){v.forEach(g.unsubscribe);});},handleAddEvent:function(o,p){if(p.flid!==this._flid||!p.uid)return;if(this._facepile.containsID(p.uid))return;if(!p.photo||!p.name){d(['ShortProfiles'],function(q){q.get(p.uid,function(r,s){if(s.exist){r.flid=this._flid;r.photo=s.thumbSrc;r.name=s.firstName;this._facepile.addFacepileItem(r);}}.bind(this,p));}.bind(this));}else this._facepile.addFacepileItem(p);h.removeClass(this._root,'empty');h.show(this._headerActions);this._listSize++;this.updateListSize();},handleRemoveEvent:function(o,p){if(p.flid!==this._flid||!p.uid)return;this._listSize--;this.updateListSize();this._facepile.removeFacepileItem(p);},updateListSize:function(){i.setContent(this._headerTitle,m._("On This List ({num_members})",{num_members:this._listSize}));}});e.exports=n;});
__d("legacy:FriendListMembersBox",["FriendListMembersBox"],function(a,b,c,d){a.FriendListMembersBox=b('FriendListMembersBox');},3);
__d("FriendListSuggestions",["Event","Arbiter","AsyncRequest","AsyncSignal","CSS","DOM","DynamicFriendListEducation","PageTransitions","Parent","copyProperties","csx","ge"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){function s(){}p(s.prototype,{init:function(t,u,v,w,x){this._container=t;this._flid=u;this._shouldSave=v;this._context=w;this._source=x;var y=g.listen(t,'click',function(aa){var ba=aa.getTarget();o.byClass(ba,'addLink')&&this._handleAdd(ba);o.byClass(ba,'declineButton')&&this._handleDecline(ba);}.bind(this)),z=h.subscribe('FriendListMemberTypeahead/add',function(aa,ba){var ca=r('suggestion_'+ba.uid);ca&&this._swap(ca);}.bind(this));n.registerHandler(function(){y.remove();z.unsubscribe();this._explicitHover&&this._explicitHover.uninstall();}.bind(this));},_handleDecline:function(t){var u=o.byTag(t,'li');this._swap(u);},_handleAdd:function(t){var u=o.byTag(t,'li'),v=this._getUIDFromItem(u),w=function(x){if(x&&x.nux_cancel)return;this._swap(u);if(this._shouldSave)this._save(v,x);var y=l.scry(u,"img._s0")[0],z=l.find(u,'td.userSuggestionName');h.inform('FriendListSuggestions/add',{flid:this._flid,uid:v,name:l.getText(z),photo:y.src});}.bind(this);m.showContextualDialog(this._flid,v,t,w);},_getUIDFromItem:function(t){return ''+t.id.split('_')[1];},_swap:function(t){l.remove(t);var u=l.scry(this._container,'li.hidden_elem')[0];if(!u)return;k.show(u);var v=this._getUIDFromItem(u),w=''+u.getAttribute('data-coeff-key'),x={tids:[v],key:w};new j('/friends/ajax/log_data.php',x).send();},_save:function(t,u){var v={flid:this._flid,id:t,add:1,source:this._source};v[this.context]=1;if(u)p(v,u);new i().setURI('/friends/ajax/lists.php').setData(v).send();}});e.exports=s;});
__d("legacy:FriendListSuggestions",["FriendListSuggestions"],function(a,b,c,d){a.FriendListSuggestions=b('FriendListSuggestions');},3);
__d("FriendListMemberBoxTypeahead",["Arbiter","AsyncRequest","CSS","DynamicFriendListEducation","Event","PageTransitions","Style","copyProperties","removeFromArray"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(){}n(p.prototype,{init:function(q,r,s){k.listen(q.getCore().getElement(),'keyup',function(event){i.conditionClass(event.getTarget(),'noPadding',m.get(event.getTarget(),'direction')=='rtl');});q.subscribe('select',function(u,v){var w=function(y){g.inform('FriendListMemberTypeahead/add',{flid:r,uid:v.selected.uid,name:v.selected.text,path:v.selected.path,photo:v.selected.photo});var z={add:1,search:1,source:s,flid:r,id:v.selected.uid};n(z,y);new h().setURI('/friends/ajax/lists.php').setData(z).send();};if(v.selected.subscribee||v.selected.type=='page')return w();j.showDialog(r,v.selected.uid,w);var x=q.getData().getExclusions();x.push(v.selected.uid);q.getData().setExclusions(x);});var t=g.subscribe('listeditor/friend_lists_changed',function(u,v){if(v.list_info.list_id==r){var w=q.getData().getExclusions();if(v.removed_uid){o(w,v.removed_uid);}else if(v.added_uid)w.push(v.added_uid);q.getData().setExclusions(w);}},g.SUBSCRIBE_NEW);l.registerHandler(g.unsubscribe.bind(null,t));}});e.exports=p;});
__d("legacy:FriendListMemberBoxTypeahead",["FriendListMemberBoxTypeahead"],function(a,b,c,d){a.FriendListMemberBoxTypeahead=b('FriendListMemberBoxTypeahead');},3);